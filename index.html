<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Charmers Checkout</title>
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
    }
    #payment-request-button {
      margin-top: 20px;
    }
    .StripeElement {
      padding: 10px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
    #card-errors {
      color: red;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>Charmers Checkout</h2>

  <form id="payment-form">
    <label>Name:<input type="text" id="name" required></label>
    <label>Phone Number:<input type="tel" id="phone" required></label>
    <label>Email:<input type="email" id="email" required></label>
    <label>Street Address:<input type="text" id="address" required></label>
    <label>Street Address 2 (Optional):<input type="text" id="address2"></label>
    <label>City:<input type="text" id="city" required></label>
    <label>State/Territory:<input type="text" id="state" required></label>
    <label>Country:<input type="text" id="country" required></label>

    <label>Bracelet Size:
      <select id="bracelet-size">
        <option>XS</option>
        <option>S</option>
        <option>M</option>
        <option>L</option>
        <option>XL</option>
        <option>XXL</option>
        <option>XXXL</option>
      </select>
    </label>

    <label>Payment Method:
      <select id="payment-method">
        <option>Credit/Debit</option>
        <option>Apple Pay</option>
        <option>Google Pay</option>
      </select>
    </label>

    <div id="payment-request-button"></div>
    <div id="card-element" class="StripeElement"></div>
    <div id="card-errors"></div>

    <p><strong>Total:</strong> $5.00</p>
    <button type="submit">Pay Now</button>
  </form>

  <script>
    const stripe = Stripe("pk_live_51ReQgoHwN7YkNv6zwRaz8N1GO0PL7Bb3pqUbcxhss5cQQpJFKjoiNJR4DWKeTRWwhw2tmejOtXjbnrIg6sHnhxc600ePIEIgBc");
    const elements = stripe.elements();

    const card = elements.create("card");
    card.mount("#card-element");

    card.on("change", function(event) {
      const displayError = document.getElementById("card-errors");
      if (event.error) {
        displayError.textContent = event.error.message;
      } else {
        displayError.textContent = "";
      }
    });

    const paymentRequest = stripe.paymentRequest({
      country: "US",
      currency: "usd",
      total: {
        label: "Charmers Bracelet",
        amount: 500,
      },
      requestPayerName: true,
      requestPayerEmail: true,
    });

    const prButton = elements.create("paymentRequestButton", {
      paymentRequest,
      style: {
        paymentRequestButton: {
          type: "default",
          theme: "light",
          height: "44px",
        },
      },
    });

    paymentRequest.canMakePayment().then(function(result) {
      if (result) {
        document.getElementById("payment-request-button").style.display = "block";
        prButton.mount("#payment-request-button");
      } else {
        document.getElementById("payment-request-button").style.display = "none";
      }
    });

    paymentRequest.on("paymentmethod", function(ev) {
      ev.complete("success");
      alert("Payment successful via Apple Pay or Google Pay: " + ev.paymentMethod.id);
    });

    const form = document.getElementById("payment-form");
    form.addEventListener("submit", function(event) {
      event.preventDefault();
      stripe.createToken(card).then(function(result) {
        if (result.error) {
          document.getElementById("card-errors").textContent = result.error.message;
        } else {
          alert("Card Token Created: " + result.token.id);
        }
      });
    });
  </script>
</body>
</html>
